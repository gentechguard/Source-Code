{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 22, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/puvvu/OneDrive/Documents/web/gentech-guard-gemini/components/Beams.tsx"],"sourcesContent":["import { forwardRef, useImperativeHandle, useEffect, useRef, useMemo, FC, ReactNode } from 'react';\r\n\r\nimport * as THREE from 'three';\r\n\r\nimport { Canvas, useFrame } from '@react-three/fiber';\r\nimport { PerspectiveCamera } from '@react-three/drei';\r\nimport { degToRad } from 'three/src/math/MathUtils.js';\r\n\r\ntype UniformValue = THREE.IUniform<unknown> | unknown;\r\n\r\ninterface ExtendMaterialConfig {\r\n    header: string;\r\n    vertexHeader?: string;\r\n    fragmentHeader?: string;\r\n    material?: THREE.MeshPhysicalMaterialParameters & { fog?: boolean };\r\n    uniforms?: Record<string, UniformValue>;\r\n    vertex?: Record<string, string>;\r\n    fragment?: Record<string, string>;\r\n}\r\n\r\ntype ShaderWithDefines = THREE.ShaderLibShader & {\r\n    defines?: Record<string, string | number | boolean>;\r\n};\r\n\r\nfunction extendMaterial<T extends THREE.Material = THREE.Material>(\r\n    BaseMaterial: new (params?: THREE.MaterialParameters) => T,\r\n    cfg: ExtendMaterialConfig\r\n): THREE.ShaderMaterial {\r\n    const physical = THREE.ShaderLib.physical as ShaderWithDefines;\r\n    const { vertexShader: baseVert, fragmentShader: baseFrag, uniforms: baseUniforms } = physical;\r\n    const baseDefines = physical.defines ?? {};\r\n\r\n    const uniforms: Record<string, THREE.IUniform> = THREE.UniformsUtils.clone(baseUniforms);\r\n\r\n    const defaults = new BaseMaterial(cfg.material || {}) as T & {\r\n        color?: THREE.Color;\r\n        roughness?: number;\r\n        metalness?: number;\r\n        envMap?: THREE.Texture;\r\n        envMapIntensity?: number;\r\n    };\r\n\r\n    if (defaults.color) uniforms.diffuse.value = defaults.color;\r\n    if ('roughness' in defaults) uniforms.roughness.value = defaults.roughness;\r\n    if ('metalness' in defaults) uniforms.metalness.value = defaults.metalness;\r\n    if ('envMap' in defaults) uniforms.envMap.value = defaults.envMap;\r\n    if ('envMapIntensity' in defaults) uniforms.envMapIntensity.value = defaults.envMapIntensity;\r\n\r\n    Object.entries(cfg.uniforms ?? {}).forEach(([key, u]) => {\r\n        uniforms[key] =\r\n            u !== null && typeof u === 'object' && 'value' in u\r\n                ? (u as THREE.IUniform<unknown>)\r\n                : ({ value: u } as THREE.IUniform<unknown>);\r\n    });\r\n\r\n    let vert = `${cfg.header}\\n${cfg.vertexHeader ?? ''}\\n${baseVert}`;\r\n    let frag = `${cfg.header}\\n${cfg.fragmentHeader ?? ''}\\n${baseFrag}`;\r\n\r\n    for (const [inc, code] of Object.entries(cfg.vertex ?? {})) {\r\n        vert = vert.replace(inc, `${inc}\\n${code}`);\r\n    }\r\n    for (const [inc, code] of Object.entries(cfg.fragment ?? {})) {\r\n        frag = frag.replace(inc, `${inc}\\n${code}`);\r\n    }\r\n\r\n    const mat = new THREE.ShaderMaterial({\r\n        defines: { ...baseDefines },\r\n        uniforms,\r\n        vertexShader: vert,\r\n        fragmentShader: frag,\r\n        lights: true,\r\n        fog: !!cfg.material?.fog\r\n    });\r\n\r\n    return mat;\r\n}\r\n\r\nconst CanvasWrapper: FC<{ children: ReactNode }> = ({ children }) => (\r\n    <Canvas dpr={[1, 2]} frameloop=\"always\" className=\"w-full h-full relative\">\r\n        {children}\r\n    </Canvas>\r\n);\r\n\r\nconst hexToNormalizedRGB = (hex: string): [number, number, number] => {\r\n    const clean = hex.replace('#', '');\r\n    const r = parseInt(clean.substring(0, 2), 16);\r\n    const g = parseInt(clean.substring(2, 4), 16);\r\n    const b = parseInt(clean.substring(4, 6), 16);\r\n    return [r / 255, g / 255, b / 255];\r\n};\r\n\r\nconst noise = `\r\nfloat random (in vec2 st) {\r\n    return fract(sin(dot(st.xy,\r\n                         vec2(12.9898,78.233)))*\r\n        43758.5453123);\r\n}\r\nfloat noise (in vec2 st) {\r\n    vec2 i = floor(st);\r\n    vec2 f = fract(st);\r\n    float a = random(i);\r\n    float b = random(i + vec2(1.0, 0.0));\r\n    float c = random(i + vec2(0.0, 1.0));\r\n    float d = random(i + vec2(1.0, 1.0));\r\n    vec2 u = f * f * (3.0 - 2.0 * f);\r\n    return mix(a, b, u.x) +\r\n           (c - a)* u.y * (1.0 - u.x) +\r\n           (d - b) * u.x * u.y;\r\n}\r\nvec4 permute(vec4 x){return mod(((x*34.0)+1.0)*x, 289.0);}\r\nvec4 taylorInvSqrt(vec4 r){return 1.79284291400159 - 0.85373472095314 * r;}\r\nvec3 fade(vec3 t) {return t*t*t*(t*(t*6.0-15.0)+10.0);}\r\nfloat cnoise(vec3 P){\r\n  vec3 Pi0 = floor(P);\r\n  vec3 Pi1 = Pi0 + vec3(1.0);\r\n  Pi0 = mod(Pi0, 289.0);\r\n  Pi1 = mod(Pi1, 289.0);\r\n  vec3 Pf0 = fract(P);\r\n  vec3 Pf1 = Pf0 - vec3(1.0);\r\n  vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);\r\n  vec4 iy = vec4(Pi0.yy, Pi1.yy);\r\n  vec4 iz0 = Pi0.zzzz;\r\n  vec4 iz1 = Pi1.zzzz;\r\n  vec4 ixy = permute(permute(ix) + iy);\r\n  vec4 ixy0 = permute(ixy + iz0);\r\n  vec4 ixy1 = permute(ixy + iz1);\r\n  vec4 gx0 = ixy0 / 7.0;\r\n  vec4 gy0 = fract(floor(gx0) / 7.0) - 0.5;\r\n  gx0 = fract(gx0);\r\n  vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);\r\n  vec4 sz0 = step(gz0, vec4(0.0));\r\n  gx0 -= sz0 * (step(0.0, gx0) - 0.5);\r\n  gy0 -= sz0 * (step(0.0, gy0) - 0.5);\r\n  vec4 gx1 = ixy1 / 7.0;\r\n  vec4 gy1 = fract(floor(gx1) / 7.0) - 0.5;\r\n  gx1 = fract(gx1);\r\n  vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);\r\n  vec4 sz1 = step(gz1, vec4(0.0));\r\n  gx1 -= sz1 * (step(0.0, gx1) - 0.5);\r\n  gy1 -= sz1 * (step(0.0, gy1) - 0.5);\r\n  vec3 g000 = vec3(gx0.x,gy0.x,gz0.x);\r\n  vec3 g100 = vec3(gx0.y,gy0.y,gz0.y);\r\n  vec3 g010 = vec3(gx0.z,gy0.z,gz0.z);\r\n  vec3 g110 = vec3(gx0.w,gy0.w,gz0.w);\r\n  vec3 g001 = vec3(gx1.x,gy1.x,gz1.x);\r\n  vec3 g101 = vec3(gx1.y,gy1.y,gz1.y);\r\n  vec3 g011 = vec3(gx1.z,gy1.z,gz1.z);\r\n  vec3 g111 = vec3(gx1.w,gy1.w,gz1.w);\r\n  vec4 norm0 = taylorInvSqrt(vec4(dot(g000,g000),dot(g010,g010),dot(g100,g100),dot(g110,g110)));\r\n  g000 *= norm0.x; g010 *= norm0.y; g100 *= norm0.z; g110 *= norm0.w;\r\n  vec4 norm1 = taylorInvSqrt(vec4(dot(g001,g001),dot(g011,g011),dot(g101,g101),dot(g111,g111)));\r\n  g001 *= norm1.x; g011 *= norm1.y; g101 *= norm1.z; g111 *= norm1.w;\r\n  float n000 = dot(g000, Pf0);\r\n  float n100 = dot(g100, vec3(Pf1.x,Pf0.yz));\r\n  float n010 = dot(g010, vec3(Pf0.x,Pf1.y,Pf0.z));\r\n  float n110 = dot(g110, vec3(Pf1.xy,Pf0.z));\r\n  float n001 = dot(g001, vec3(Pf0.xy,Pf1.z));\r\n  float n101 = dot(g101, vec3(Pf1.x,Pf0.y,Pf1.z));\r\n  float n011 = dot(g011, vec3(Pf0.x,Pf1.yz));\r\n  float n111 = dot(g111, Pf1);\r\n  vec3 fade_xyz = fade(Pf0);\r\n  vec4 n_z = mix(vec4(n000,n100,n010,n110),vec4(n001,n101,n011,n111),fade_xyz.z);\r\n  vec2 n_yz = mix(n_z.xy,n_z.zw,fade_xyz.y);\r\n  float n_xyz = mix(n_yz.x,n_yz.y,fade_xyz.x);\r\n  return 2.2 * n_xyz;\r\n}\r\n`;\r\n\r\ninterface BeamsProps {\r\n    beamWidth?: number;\r\n    beamHeight?: number;\r\n    beamNumber?: number;\r\n    lightColor?: string;\r\n    speed?: number;\r\n    noiseIntensity?: number;\r\n    scale?: number;\r\n    rotation?: number;\r\n}\r\n\r\nconst Beams: FC<BeamsProps> = ({\r\n    beamWidth = 2,\r\n    beamHeight = 15,\r\n    beamNumber = 12,\r\n    lightColor = '#ffffff',\r\n    speed = 2,\r\n    noiseIntensity = 1.75,\r\n    scale = 0.2,\r\n    rotation = 0\r\n}) => {\r\n    const meshRef = useRef<THREE.Mesh<THREE.BufferGeometry, THREE.ShaderMaterial>>(null!);\r\n\r\n    const beamMaterial = useMemo(\r\n        () =>\r\n            extendMaterial(THREE.MeshStandardMaterial, {\r\n                header: `\r\n  varying vec3 vEye;\r\n  varying float vNoise;\r\n  varying vec2 vUv;\r\n  varying vec3 vPosition;\r\n  uniform float time;\r\n  uniform float uSpeed;\r\n  uniform float uNoiseIntensity;\r\n  uniform float uScale;\r\n  ${noise}`,\r\n                vertexHeader: `\r\n  float getPos(vec3 pos) {\r\n    vec3 noisePos =\r\n      vec3(pos.x * 0., pos.y - uv.y, pos.z + time * uSpeed * 3.) * uScale;\r\n    return cnoise(noisePos);\r\n  }\r\n  vec3 getCurrentPos(vec3 pos) {\r\n    vec3 newpos = pos;\r\n    newpos.z += getPos(pos);\r\n    return newpos;\r\n  }\r\n  vec3 getNormal(vec3 pos) {\r\n    vec3 curpos = getCurrentPos(pos);\r\n    vec3 nextposX = getCurrentPos(pos + vec3(0.01, 0.0, 0.0));\r\n    vec3 nextposZ = getCurrentPos(pos + vec3(0.0, -0.01, 0.0));\r\n    vec3 tangentX = normalize(nextposX - curpos);\r\n    vec3 tangentZ = normalize(nextposZ - curpos);\r\n    return normalize(cross(tangentZ, tangentX));\r\n  }`,\r\n                fragmentHeader: '',\r\n                vertex: {\r\n                    '#include <begin_vertex>': `transformed.z += getPos(transformed.xyz);`,\r\n                    '#include <beginnormal_vertex>': `objectNormal = getNormal(position.xyz);`\r\n                },\r\n                fragment: {\r\n                    '#include <dithering_fragment>': `\r\n    float randomNoise = noise(gl_FragCoord.xy);\r\n    gl_FragColor.rgb -= randomNoise / 15. * uNoiseIntensity;`\r\n                },\r\n                material: { fog: true },\r\n                uniforms: {\r\n                    diffuse: new THREE.Color(...hexToNormalizedRGB('#000000')),\r\n                    time: { shared: true, mixed: true, linked: true, value: 0 },\r\n                    roughness: 0.3,\r\n                    metalness: 0.3,\r\n                    uSpeed: { shared: true, mixed: true, linked: true, value: speed },\r\n                    envMapIntensity: 10,\r\n                    uNoiseIntensity: noiseIntensity,\r\n                    uScale: scale\r\n                }\r\n            }),\r\n        [speed, noiseIntensity, scale]\r\n    );\r\n\r\n    return (\r\n        <CanvasWrapper>\r\n            <group rotation={[0, 0, degToRad(rotation)]}>\r\n                <PlaneNoise ref={meshRef} material={beamMaterial} count={beamNumber} width={beamWidth} height={beamHeight} />\r\n                <DirLight color={lightColor} position={[0, 3, 10]} />\r\n            </group>\r\n            <ambientLight intensity={1} />\r\n            <color attach=\"background\" args={['#000000']} />\r\n            <PerspectiveCamera makeDefault position={[0, 0, 20]} fov={30} />\r\n        </CanvasWrapper>\r\n    );\r\n};\r\n\r\nfunction createStackedPlanesBufferGeometry(\r\n    n: number,\r\n    width: number,\r\n    height: number,\r\n    spacing: number,\r\n    heightSegments: number\r\n): THREE.BufferGeometry {\r\n    const geometry = new THREE.BufferGeometry();\r\n    const numVertices = n * (heightSegments + 1) * 2;\r\n    const numFaces = n * heightSegments * 2;\r\n    const positions = new Float32Array(numVertices * 3);\r\n    const indices = new Uint32Array(numFaces * 3);\r\n    const uvs = new Float32Array(numVertices * 2);\r\n\r\n    let vertexOffset = 0;\r\n    let indexOffset = 0;\r\n    let uvOffset = 0;\r\n    const totalWidth = n * width + (n - 1) * spacing;\r\n    const xOffsetBase = -totalWidth / 2;\r\n\r\n    for (let i = 0; i < n; i++) {\r\n        const xOffset = xOffsetBase + i * (width + spacing);\r\n        const uvXOffset = Math.random() * 300;\r\n        const uvYOffset = Math.random() * 300;\r\n\r\n        for (let j = 0; j <= heightSegments; j++) {\r\n            const y = height * (j / heightSegments - 0.5);\r\n            const v0 = [xOffset, y, 0];\r\n            const v1 = [xOffset + width, y, 0];\r\n            positions.set([...v0, ...v1], vertexOffset * 3);\r\n\r\n            const uvY = j / heightSegments;\r\n            uvs.set([uvXOffset, uvY + uvYOffset, uvXOffset + 1, uvY + uvYOffset], uvOffset);\r\n\r\n            if (j < heightSegments) {\r\n                const a = vertexOffset,\r\n                    b = vertexOffset + 1,\r\n                    c = vertexOffset + 2,\r\n                    d = vertexOffset + 3;\r\n                indices.set([a, b, c, c, b, d], indexOffset);\r\n                indexOffset += 6;\r\n            }\r\n            vertexOffset += 2;\r\n            uvOffset += 4;\r\n        }\r\n    }\r\n\r\n    geometry.setAttribute('position', new THREE.BufferAttribute(positions, 3));\r\n    geometry.setAttribute('uv', new THREE.BufferAttribute(uvs, 2));\r\n    geometry.setIndex(new THREE.BufferAttribute(indices, 1));\r\n    geometry.computeVertexNormals();\r\n    return geometry;\r\n}\r\n\r\nconst MergedPlanes = forwardRef<\r\n    THREE.Mesh<THREE.BufferGeometry, THREE.ShaderMaterial>,\r\n    {\r\n        material: THREE.ShaderMaterial;\r\n        width: number;\r\n        count: number;\r\n        height: number;\r\n    }\r\n>(({ material, width, count, height }, ref) => {\r\n    const mesh = useRef<THREE.Mesh<THREE.BufferGeometry, THREE.ShaderMaterial>>(null!);\r\n    useImperativeHandle(ref, () => mesh.current);\r\n    const geometry = useMemo(\r\n        () => createStackedPlanesBufferGeometry(count, width, height, 0, 100),\r\n        [count, width, height]\r\n    );\r\n    useFrame((_, delta) => {\r\n        mesh.current.material.uniforms.time.value += 0.1 * delta;\r\n    });\r\n    return <mesh ref={mesh} geometry={geometry} material={material} />;\r\n});\r\nMergedPlanes.displayName = 'MergedPlanes';\r\n\r\nconst PlaneNoise = forwardRef<\r\n    THREE.Mesh<THREE.BufferGeometry, THREE.ShaderMaterial>,\r\n    {\r\n        material: THREE.ShaderMaterial;\r\n        width: number;\r\n        count: number;\r\n        height: number;\r\n    }\r\n>((props, ref) => (\r\n    <MergedPlanes ref={ref} material={props.material} width={props.width} count={props.count} height={props.height} />\r\n));\r\nPlaneNoise.displayName = 'PlaneNoise';\r\n\r\nconst DirLight: FC<{ position: [number, number, number]; color: string }> = ({ position, color }) => {\r\n    const dir = useRef<THREE.DirectionalLight>(null!);\r\n    useEffect(() => {\r\n        if (!dir.current) return;\r\n        const cam = dir.current.shadow.camera as THREE.Camera & {\r\n            top: number;\r\n            bottom: number;\r\n            left: number;\r\n            right: number;\r\n            far: number;\r\n        };\r\n        cam.top = 24;\r\n        cam.bottom = -24;\r\n        cam.left = -24;\r\n        cam.right = 24;\r\n        cam.far = 64;\r\n        dir.current.shadow.bias = -0.004;\r\n    }, []);\r\n    return <directionalLight ref={dir} color={color} intensity={1} position={position} />;\r\n};\r\n\r\nexport default Beams;\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 444, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/puvvu/OneDrive/Documents/web/gentech-guard-gemini/components/MetallicPaint.tsx"],"sourcesContent":["import React, { useEffect, useRef, useState } from 'react';\r\n\r\nexport type ShaderParams = {\r\n    patternScale: number;\r\n    refraction: number;\r\n    edge: number;\r\n    patternBlur: number;\r\n    liquid: number;\r\n    speed: number;\r\n};\r\n\r\nexport const defaultParams: ShaderParams = {\r\n    patternScale: 2,\r\n    refraction: 0.015,\r\n    edge: 0.0,\r\n    patternBlur: 0.01,\r\n    liquid: 0.1,\r\n    speed: 0.3\r\n};\r\n\r\n/**\r\n * Pre-processes the image to generate a height map for the fluid simulation.\r\n */\r\nexport function parseLogoImage(file: File): Promise<{ imageData: ImageData }> {\r\n    return new Promise((resolve, reject) => {\r\n        const canvas = document.createElement('canvas');\r\n        const ctx = canvas.getContext('2d', { willReadFrequently: true });\r\n\r\n        if (!file || !ctx) {\r\n            reject(new Error('Invalid file or context'));\r\n            return;\r\n        }\r\n\r\n        const img = new Image();\r\n        // Important for loading external URLs if CORS allows\r\n        img.crossOrigin = 'anonymous';\r\n\r\n        img.onload = function () {\r\n            URL.revokeObjectURL(img.src);\r\n\r\n            let width = img.naturalWidth || img.width;\r\n            let height = img.naturalHeight || img.height;\r\n\r\n            // Fallback for SVGs without intrinsic dimensions\r\n            if (width === 0 || height === 0) {\r\n                width = 800;\r\n                height = 800;\r\n            }\r\n\r\n            // Constrain size for performance\r\n            const MAX_SIZE = 400;\r\n            const MIN_SIZE = 200;\r\n\r\n            if (width > MAX_SIZE || height > MAX_SIZE || width < MIN_SIZE || height < MIN_SIZE) {\r\n                if (width > height) {\r\n                    if (width > MAX_SIZE) {\r\n                        height = Math.round((height * MAX_SIZE) / width);\r\n                        width = MAX_SIZE;\r\n                    } else if (width < MIN_SIZE) {\r\n                        height = Math.round((height * MIN_SIZE) / width);\r\n                        width = MIN_SIZE;\r\n                    }\r\n                } else {\r\n                    if (height > MAX_SIZE) {\r\n                        width = Math.round((width * MAX_SIZE) / height);\r\n                        height = MAX_SIZE;\r\n                    } else if (height < MIN_SIZE) {\r\n                        width = Math.round((width * MIN_SIZE) / height);\r\n                        height = MIN_SIZE;\r\n                    }\r\n                }\r\n            }\r\n\r\n            width = Math.floor(width);\r\n            height = Math.floor(height);\r\n\r\n            canvas.width = width;\r\n            canvas.height = height;\r\n\r\n            // Draw original image\r\n            const shapeCanvas = document.createElement('canvas');\r\n            shapeCanvas.width = width;\r\n            shapeCanvas.height = height;\r\n            const shapeCtx = shapeCanvas.getContext('2d', { willReadFrequently: true })!;\r\n            shapeCtx.drawImage(img, 0, 0, width, height);\r\n\r\n            const shapeImageData = shapeCtx.getImageData(0, 0, width, height);\r\n            const data = shapeImageData.data;\r\n            const shapeMask = new Array(width * height).fill(false);\r\n\r\n            // Create mask: true if pixel is NOT white and NOT transparent (assuming black/colored logo on transparent/white bg)\r\n            for (let y = 0; y < height; y++) {\r\n                for (let x = 0; x < width; x++) {\r\n                    const idx4 = (y * width + x) * 4;\r\n                    const r = data[idx4];\r\n                    const g = data[idx4 + 1];\r\n                    const b = data[idx4 + 2];\r\n                    const a = data[idx4 + 3];\r\n                    shapeMask[y * width + x] = !((r > 240 && g > 240 && b > 240) || a < 10);\r\n                }\r\n            }\r\n\r\n            function inside(x: number, y: number) {\r\n                if (x < 0 || x >= width || y < 0 || y >= height) return false;\r\n                return shapeMask[y * width + x];\r\n            }\r\n\r\n            // Identify boundaries for heat source\r\n            const boundaryMask = new Array(width * height).fill(false);\r\n            for (let y = 0; y < height; y++) {\r\n                for (let x = 0; x < width; x++) {\r\n                    const idx = y * width + x;\r\n                    if (!shapeMask[idx]) continue;\r\n                    let isBoundary = false;\r\n                    // 4-neighbor check for speed\r\n                    if (!inside(x + 1, y) || !inside(x - 1, y) || !inside(x, y + 1) || !inside(x, y - 1)) {\r\n                        boundaryMask[idx] = true;\r\n                    }\r\n                }\r\n            }\r\n\r\n            // Heat equation solver\r\n            const u = new Float32Array(width * height).fill(0);\r\n            const newU = new Float32Array(width * height).fill(0);\r\n            const C = 0.01;\r\n            // Reduced iterations for performance\r\n            const ITERATIONS = 40;\r\n\r\n            function getU(x: number, y: number, arr: Float32Array) {\r\n                if (x < 0 || x >= width || y < 0 || y >= height) return 0;\r\n                if (!shapeMask[y * width + x]) return 0;\r\n                return arr[y * width + x];\r\n            }\r\n\r\n            for (let iter = 0; iter < ITERATIONS; iter++) {\r\n                for (let y = 0; y < height; y++) {\r\n                    for (let x = 0; x < width; x++) {\r\n                        const idx = y * width + x;\r\n                        if (!shapeMask[idx] || boundaryMask[idx]) {\r\n                            newU[idx] = 0; // Boundary/Outside is 0 (heat sink)\r\n                            continue;\r\n                        }\r\n                        // Simple Laplacian\r\n                        const sumN = getU(x + 1, y, u) + getU(x - 1, y, u) + getU(x, y + 1, u) + getU(x, y - 1, u);\r\n                        newU[idx] = (C + sumN) / 4;\r\n                    }\r\n                }\r\n                u.set(newU);\r\n            }\r\n\r\n            let maxVal = 0;\r\n            for (let i = 0; i < width * height; i++) {\r\n                if (u[i] > maxVal) maxVal = u[i];\r\n            }\r\n\r\n            const alpha = 2.0;\r\n            const outImg = ctx.createImageData(width, height);\r\n\r\n            // Generate height map texture\r\n            for (let y = 0; y < height; y++) {\r\n                for (let x = 0; x < width; x++) {\r\n                    const idx = y * width + x;\r\n                    const px = idx * 4;\r\n                    if (!shapeMask[idx]) {\r\n                        // CRITICAL FIX: Set background color to 255 (Edge) instead of 0 (Center)\r\n                        // This ensures that interpolation at edges doesn't pass through the \"solid\" value (0)\r\n                        outImg.data[px] = 255;\r\n                        outImg.data[px + 1] = 255;\r\n                        outImg.data[px + 2] = 255;\r\n                        outImg.data[px + 3] = 0; // Transparent alpha\r\n                    } else {\r\n                        const raw = maxVal > 0 ? u[idx] / maxVal : 0;\r\n                        const remapped = Math.pow(raw, alpha);\r\n                        const gray = Math.floor(255 * (1 - remapped));\r\n                        outImg.data[px] = gray;\r\n                        outImg.data[px + 1] = gray;\r\n                        outImg.data[px + 2] = gray;\r\n                        outImg.data[px + 3] = 255;\r\n                    }\r\n                }\r\n            }\r\n            resolve({ imageData: outImg });\r\n        };\r\n\r\n        img.onerror = (e) => reject(new Error('Failed to load image'));\r\n\r\n        // Create object URL from File object\r\n        img.src = URL.createObjectURL(file);\r\n    });\r\n}\r\n\r\nconst vertexShaderSource = `#version 300 es\r\nprecision mediump float;\r\nin vec2 a_position;\r\nout vec2 vUv;\r\nvoid main() {\r\n    vUv = .5 * (a_position + 1.);\r\n    gl_Position = vec4(a_position, 0.0, 1.0);\r\n}`;\r\n\r\nconst liquidFragSource = `#version 300 es\r\nprecision mediump float;\r\nin vec2 vUv;\r\nout vec4 fragColor;\r\nuniform sampler2D u_image_texture;\r\nuniform float u_time;\r\nuniform float u_ratio;\r\nuniform float u_img_ratio;\r\nuniform float u_patternScale;\r\nuniform float u_refraction;\r\nuniform float u_edge;\r\nuniform float u_patternBlur;\r\nuniform float u_liquid;\r\n\r\n#define PI 3.14159265358979323846\r\n\r\nvec3 mod289(vec3 x) { return x - floor(x * (1. / 289.)) * 289.; }\r\nvec2 mod289(vec2 x) { return x - floor(x * (1. / 289.)) * 289.; }\r\nvec3 permute(vec3 x) { return mod289(((x*34.)+1.)*x); }\r\nfloat snoise(vec2 v) {\r\n    const vec4 C = vec4(0.211324865405187, 0.366025403784439, -0.577350269189626, 0.024390243902439);\r\n    vec2 i = floor(v + dot(v, C.yy));\r\n    vec2 x0 = v - i + dot(i, C.xx);\r\n    vec2 i1;\r\n    i1 = (x0.x > x0.y) ? vec2(1., 0.) : vec2(0., 1.);\r\n    vec4 x12 = x0.xyxy + C.xxzz;\r\n    x12.xy -= i1;\r\n    i = mod289(i);\r\n    vec3 p = permute(permute(i.y + vec3(0., i1.y, 1.)) + i.x + vec3(0., i1.x, 1.));\r\n    vec3 m = max(0.5 - vec3(dot(x0, x0), dot(x12.xy, x12.xy), dot(x12.zw, x12.zw)), 0.);\r\n    m = m*m;\r\n    m = m*m;\r\n    vec3 x = 2. * fract(p * C.www) - 1.;\r\n    vec3 h = abs(x) - 0.5;\r\n    vec3 ox = floor(x + 0.5);\r\n    vec3 a0 = x - ox;\r\n    m *= 1.79284291400159 - 0.85373472095314 * (a0*a0 + h*h);\r\n    vec3 g;\r\n    g.x = a0.x * x0.x + h.x * x0.y;\r\n    g.yz = a0.yz * x12.xz + h.yz * x12.yw;\r\n    return 130. * dot(m, g);\r\n}\r\n\r\nvec2 get_img_uv() {\r\n    vec2 img_uv = vUv;\r\n    img_uv -= .5;\r\n    if (u_ratio > u_img_ratio) {\r\n        img_uv.x = img_uv.x * u_ratio / u_img_ratio;\r\n    } else {\r\n        img_uv.y = img_uv.y * u_img_ratio / u_ratio;\r\n    }\r\n    img_uv += .5;\r\n    img_uv.y = 1. - img_uv.y;\r\n    return img_uv;\r\n}\r\nvec2 rotate(vec2 uv, float th) {\r\n    return mat2(cos(th), sin(th), -sin(th), cos(th)) * uv;\r\n}\r\nfloat get_color_channel(float c1, float c2, float stripe_p, vec3 w, float extra_blur, float b) {\r\n    float ch = c2;\r\n    float border = 0.;\r\n    float blur = u_patternBlur + extra_blur;\r\n    ch = mix(ch, c1, smoothstep(.0, blur, stripe_p));\r\n    border = w[0];\r\n    ch = mix(ch, c2, smoothstep(border - blur, border + blur, stripe_p));\r\n    b = smoothstep(.2, .8, b);\r\n    border = w[0] + .4 * (1. - b) * w[1];\r\n    ch = mix(ch, c1, smoothstep(border - blur, border + blur, stripe_p));\r\n    border = w[0] + .5 * (1. - b) * w[1];\r\n    ch = mix(ch, c2, smoothstep(border - blur, border + blur, stripe_p));\r\n    border = w[0] + w[1];\r\n    ch = mix(ch, c1, smoothstep(border - blur, border + blur, stripe_p));\r\n    float gradient_t = (stripe_p - w[0] - w[1]) / w[2];\r\n    float gradient = mix(c1, c2, smoothstep(0., 1., gradient_t));\r\n    ch = mix(ch, gradient, smoothstep(border - blur, border + blur, stripe_p));\r\n    return ch;\r\n}\r\nfloat get_img_frame_alpha(vec2 uv, float img_frame_width) {\r\n    float img_frame_alpha = smoothstep(0., img_frame_width, uv.x) * smoothstep(1., 1. - img_frame_width, uv.x);\r\n    img_frame_alpha *= smoothstep(0., img_frame_width, uv.y) * smoothstep(1., 1. - img_frame_width, uv.y);\r\n    return img_frame_alpha;\r\n}\r\nvoid main() {\r\n    vec2 uv = vUv;\r\n    uv.y = 1. - uv.y;\r\n    uv.x *= u_ratio;\r\n    float diagonal = uv.x - uv.y;\r\n    float t = .001 * u_time;\r\n    vec2 img_uv = get_img_uv();\r\n    vec4 img = texture(u_image_texture, img_uv);\r\n    vec3 color = vec3(0.);\r\n    float opacity = 1.;\r\n    vec3 color1 = vec3(.98, 0.98, 1.);\r\n    vec3 color2 = vec3(.1, .1, .1 + .1 * smoothstep(.7, 1.3, uv.x + uv.y));\r\n    float edge = img.r;\r\n    vec2 grad_uv = uv;\r\n    grad_uv -= .5;\r\n    float dist = length(grad_uv + vec2(0., .2 * diagonal));\r\n    grad_uv = rotate(grad_uv, (.25 - .2 * diagonal) * PI);\r\n    float bulge = pow(1.8 * dist, 1.2);\r\n    bulge = 1. - bulge;\r\n    bulge *= pow(uv.y, .3);\r\n    float cycle_width = u_patternScale;\r\n    float thin_strip_1_ratio = .12 / cycle_width * (1. - .4 * bulge);\r\n    float thin_strip_2_ratio = .07 / cycle_width * (1. + .4 * bulge);\r\n    float wide_strip_ratio = (1. - thin_strip_1_ratio - thin_strip_2_ratio);\r\n    float thin_strip_1_width = cycle_width * thin_strip_1_ratio;\r\n    float thin_strip_2_width = cycle_width * thin_strip_2_ratio;\r\n    opacity = 1. - smoothstep(.9 - .5 * u_edge, 1. - .5 * u_edge, edge);\r\n    opacity *= get_img_frame_alpha(img_uv, 0.01);\r\n    \r\n    // CRITICAL FIX: Multiply final opacity by the texture's alpha channel\r\n    // This respects the transparent parts of the original image\r\n    opacity *= img.a;\r\n\r\n    float noise = snoise(uv - t);\r\n    edge += (1. - edge) * u_liquid * noise;\r\n    float refr = 0.;\r\n    refr += (1. - bulge);\r\n    refr = clamp(refr, 0., 1.);\r\n    float dir = grad_uv.x;\r\n    dir += diagonal;\r\n    dir -= 2. * noise * diagonal * (smoothstep(0., 1., edge) * smoothstep(1., 0., edge));\r\n    bulge *= clamp(pow(uv.y, .1), .3, 1.);\r\n    dir *= (.1 + (1.1 - edge) * bulge);\r\n    dir *= smoothstep(1., .7, edge);\r\n    dir += .18 * (smoothstep(.1, .2, uv.y) * smoothstep(.4, .2, uv.y));\r\n    dir += .03 * (smoothstep(.1, .2, 1. - uv.y) * smoothstep(.4, .2, 1. - uv.y));\r\n    dir *= (.5 + .5 * pow(uv.y, 2.));\r\n    dir *= cycle_width;\r\n    dir -= t;\r\n    float refr_r = refr;\r\n    refr_r += .03 * bulge * noise;\r\n    float refr_b = 1.3 * refr;\r\n    refr_r += 5. * (smoothstep(-.1, .2, uv.y) * smoothstep(.5, .1, uv.y)) * (smoothstep(.4, .6, bulge) * smoothstep(.6, .4, bulge));\r\n    refr_r -= diagonal;\r\n    refr_b += (smoothstep(0., .4, uv.y) * smoothstep(.8, .1, uv.y)) * (smoothstep(.4, .6, bulge) * smoothstep(.6, .4, bulge));\r\n    refr_b -= .2 * edge;\r\n    refr_r *= u_refraction;\r\n    refr_b *= u_refraction;\r\n    vec3 w = vec3(thin_strip_1_width, thin_strip_2_width, wide_strip_ratio);\r\n    w[1] -= .02 * smoothstep(.0, 1., edge + bulge);\r\n    float stripe_r = mod(dir + refr_r, 1.);\r\n    float r = get_color_channel(color1.r, color2.r, stripe_r, w, 0.02 + .03 * u_refraction * bulge, bulge);\r\n    float stripe_g = mod(dir, 1.);\r\n    float g = get_color_channel(color1.g, color2.g, stripe_g, w, 0.01 / (1. - diagonal), bulge);\r\n    float stripe_b = mod(dir - refr_b, 1.);\r\n    float b = get_color_channel(color1.b, color2.b, stripe_b, w, .01, bulge);\r\n    color = vec3(r, g, b);\r\n    color *= opacity;\r\n    fragColor = vec4(color, opacity);\r\n}`;\r\n\r\ninterface MetallicPaintProps {\r\n    src: string;\r\n    params?: Partial<ShaderParams>;\r\n    className?: string;\r\n}\r\n\r\nexport default function MetallicPaint({\r\n    src,\r\n    params: userParams,\r\n    className = \"\"\r\n}: MetallicPaintProps) {\r\n    const params = { ...defaultParams, ...userParams };\r\n    const canvasRef = useRef<HTMLCanvasElement>(null);\r\n    const containerRef = useRef<HTMLDivElement>(null);\r\n    const [imageData, setImageData] = useState<ImageData | null>(null);\r\n    const [loading, setLoading] = useState(false);\r\n    const [gl, setGl] = useState<WebGL2RenderingContext | null>(null);\r\n    const [uniforms, setUniforms] = useState<Record<string, WebGLUniformLocation>>({});\r\n\r\n    // Fix: State independent time tracking\r\n    const totalAnimationTime = useRef(0);\r\n    const lastRenderTime = useRef(-1);\r\n\r\n    useEffect(() => {\r\n        let active = true;\r\n        async function processImage() {\r\n            try {\r\n                setLoading(true);\r\n                const response = await fetch(src);\r\n                if (!response.ok) throw new Error(\"Failed to fetch image\");\r\n                const blob = await response.blob();\r\n\r\n                // Detect MIME type, assume SVG if unknown or if extension matches\r\n                let type = blob.type;\r\n                if (!type || type === 'application/octet-stream') {\r\n                    if (src.endsWith('.svg')) type = 'image/svg+xml';\r\n                }\r\n\r\n                const file = new File([blob], \"image\", { type });\r\n                const result = await parseLogoImage(file);\r\n\r\n                if (active) {\r\n                    setImageData(result.imageData);\r\n                    setLoading(false);\r\n                }\r\n            } catch (e) {\r\n                console.error(\"MetallicPaint load error:\", e);\r\n                if (active) setLoading(false);\r\n            }\r\n        }\r\n\r\n        if (src) {\r\n            processImage();\r\n        } else {\r\n            setImageData(null);\r\n        }\r\n\r\n        return () => { active = false; };\r\n    }, [src]);\r\n\r\n    useEffect(() => {\r\n        const canvas = canvasRef.current;\r\n        if (!canvas || !imageData) return;\r\n\r\n        // Use high resolution for quality\r\n        const SIDE = 800;\r\n        canvas.width = SIDE;\r\n        canvas.height = SIDE;\r\n\r\n        const glContext = canvas.getContext('webgl2', {\r\n            antialias: true,\r\n            alpha: true,\r\n            preserveDrawingBuffer: false\r\n        });\r\n\r\n        if (!glContext) return;\r\n\r\n        function createShader(gl: WebGL2RenderingContext, sourceCode: string, type: number) {\r\n            const shader = gl.createShader(type);\r\n            if (!shader) return null;\r\n            gl.shaderSource(shader, sourceCode);\r\n            gl.compileShader(shader);\r\n            if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\r\n                gl.deleteShader(shader);\r\n                return null;\r\n            }\r\n            return shader;\r\n        }\r\n\r\n        const vertexShader = createShader(glContext, vertexShaderSource, glContext.VERTEX_SHADER);\r\n        const fragmentShader = createShader(glContext, liquidFragSource, glContext.FRAGMENT_SHADER);\r\n        const program = glContext.createProgram();\r\n\r\n        if (!program || !vertexShader || !fragmentShader) return;\r\n\r\n        glContext.attachShader(program, vertexShader);\r\n        glContext.attachShader(program, fragmentShader);\r\n        glContext.linkProgram(program);\r\n\r\n        if (!glContext.getProgramParameter(program, glContext.LINK_STATUS)) return;\r\n\r\n        function getUniforms(program: WebGLProgram, gl: WebGL2RenderingContext) {\r\n            let uniforms: Record<string, WebGLUniformLocation> = {};\r\n            let uniformCount = gl.getProgramParameter(program, gl.ACTIVE_UNIFORMS);\r\n            for (let i = 0; i < uniformCount; i++) {\r\n                let info = gl.getActiveUniform(program, i);\r\n                if (!info) continue;\r\n                const loc = gl.getUniformLocation(program, info.name);\r\n                if (loc) uniforms[info.name] = loc;\r\n            }\r\n            return uniforms;\r\n        }\r\n        const uniformsData = getUniforms(program, glContext);\r\n        if (uniformsData) setUniforms(uniformsData);\r\n\r\n        const vertices = new Float32Array([-1, -1, 1, -1, -1, 1, 1, 1]);\r\n        const vertexBuffer = glContext.createBuffer();\r\n        glContext.bindBuffer(glContext.ARRAY_BUFFER, vertexBuffer);\r\n        glContext.bufferData(glContext.ARRAY_BUFFER, vertices, glContext.STATIC_DRAW);\r\n\r\n        glContext.useProgram(program);\r\n\r\n        const positionLocation = glContext.getAttribLocation(program, 'a_position');\r\n        glContext.enableVertexAttribArray(positionLocation);\r\n        glContext.bindBuffer(glContext.ARRAY_BUFFER, vertexBuffer);\r\n        glContext.vertexAttribPointer(positionLocation, 2, glContext.FLOAT, false, 0, 0);\r\n\r\n        const imageTexture = glContext.createTexture();\r\n        glContext.activeTexture(glContext.TEXTURE0);\r\n        glContext.bindTexture(glContext.TEXTURE_2D, imageTexture);\r\n        glContext.texParameteri(glContext.TEXTURE_2D, glContext.TEXTURE_MIN_FILTER, glContext.LINEAR);\r\n        glContext.texParameteri(glContext.TEXTURE_2D, glContext.TEXTURE_MAG_FILTER, glContext.LINEAR);\r\n        glContext.texParameteri(glContext.TEXTURE_2D, glContext.TEXTURE_WRAP_S, glContext.CLAMP_TO_EDGE);\r\n        glContext.texParameteri(glContext.TEXTURE_2D, glContext.TEXTURE_WRAP_T, glContext.CLAMP_TO_EDGE);\r\n        glContext.pixelStorei(glContext.UNPACK_ALIGNMENT, 1);\r\n        glContext.texImage2D(\r\n            glContext.TEXTURE_2D,\r\n            0,\r\n            glContext.RGBA,\r\n            imageData.width,\r\n            imageData.height,\r\n            0,\r\n            glContext.RGBA,\r\n            glContext.UNSIGNED_BYTE,\r\n            imageData.data\r\n        );\r\n\r\n        setGl(glContext);\r\n\r\n        if (uniformsData?.u_img_ratio) glContext.uniform1f(uniformsData.u_img_ratio, imageData.width / imageData.height);\r\n        if (uniformsData?.u_ratio) glContext.uniform1f(uniformsData.u_ratio, 1);\r\n        if (uniformsData?.u_image_texture) glContext.uniform1i(uniformsData.u_image_texture, 0);\r\n\r\n        return () => {\r\n            glContext.deleteProgram(program);\r\n            glContext.deleteTexture(imageTexture);\r\n        };\r\n    }, [imageData]);\r\n\r\n    useEffect(() => {\r\n        if (!gl || !uniforms) return;\r\n        gl.useProgram(gl.getParameter(gl.CURRENT_PROGRAM));\r\n        gl.uniform1f(uniforms.u_edge, params.edge);\r\n        gl.uniform1f(uniforms.u_patternBlur, params.patternBlur);\r\n        gl.uniform1f(uniforms.u_patternScale, params.patternScale);\r\n        gl.uniform1f(uniforms.u_refraction, params.refraction);\r\n        gl.uniform1f(uniforms.u_liquid, params.liquid);\r\n    }, [gl, params, uniforms]);\r\n\r\n    useEffect(() => {\r\n        if (!gl || !uniforms) return;\r\n        let renderId: number;\r\n        let isMounted = true;\r\n\r\n        // Reset timing relative to this render cycle\r\n        totalAnimationTime.current = 0;\r\n        lastRenderTime.current = -1;\r\n\r\n        function render(timestamp: number) {\r\n            if (!isMounted) return;\r\n\r\n            // Initialize on first frame\r\n            if (lastRenderTime.current === -1) {\r\n                lastRenderTime.current = timestamp;\r\n            }\r\n\r\n            const deltaTime = timestamp - lastRenderTime.current;\r\n            lastRenderTime.current = timestamp;\r\n\r\n            // Cap delta time to prevent massive jumps (e.g. background tab)\r\n            // 100ms max allowed delta\r\n            const safeDelta = Math.min(deltaTime, 100);\r\n\r\n            if (uniforms.u_time) {\r\n                totalAnimationTime.current += safeDelta * params.speed;\r\n                gl!.uniform1f(uniforms.u_time, totalAnimationTime.current);\r\n            }\r\n            gl!.drawArrays(gl!.TRIANGLE_STRIP, 0, 4);\r\n            renderId = requestAnimationFrame(render);\r\n        }\r\n\r\n        renderId = requestAnimationFrame(render);\r\n        return () => { isMounted = false; cancelAnimationFrame(renderId); };\r\n    }, [gl, params.speed, uniforms]);\r\n\r\n    useEffect(() => {\r\n        const handleResize = () => {\r\n            if (!gl || !uniforms || !imageData) return;\r\n            const imgRatio = imageData.width / imageData.height;\r\n            gl.uniform1f(uniforms.u_img_ratio, imgRatio);\r\n        };\r\n        window.addEventListener('resize', handleResize);\r\n        return () => window.removeEventListener('resize', handleResize);\r\n    }, [gl, uniforms, imageData]);\r\n\r\n    return (\r\n        <div ref={containerRef} className={`relative w-full h-full ${className}`}>\r\n            {loading && (\r\n                <div className=\"absolute inset-0 flex items-center justify-center\">\r\n                    <div className=\"w-8 h-8 border-4 border-neutral-700 border-t-white rounded-full animate-spin\"></div>\r\n                </div>\r\n            )}\r\n            <canvas\r\n                ref={canvasRef}\r\n                className=\"block w-full h-full object-cover\"\r\n                style={{ opacity: imageData ? 1 : 0, transition: 'opacity 0.5s ease' }}\r\n            />\r\n        </div>\r\n    );\r\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1013, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/puvvu/OneDrive/Documents/web/gentech-guard-gemini/app/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport Image from \"next/image\";\r\nimport { motion, AnimatePresence } from \"framer-motion\";\r\nimport { ArrowRight } from \"lucide-react\";\r\nimport Beams from \"@/components/Beams\";\r\nimport MetallicPaint from \"@/components/MetallicPaint\";\r\n\r\nexport default function EntryPage() {\r\n  const router = useRouter();\r\n  const [isMobile, setIsMobile] = useState<boolean | null>(null);\r\n  const [showSplash, setShowSplash] = useState(false);\r\n\r\n  useEffect(() => {\r\n    const checkDevice = () => {\r\n      // Check if this is the Admin APK version\r\n      const isAdminApk = process.env.NEXT_PUBLIC_ADMIN_APK === 'true';\r\n\r\n      if (isAdminApk) {\r\n        // Force redirect to admin if it's the admin app\r\n        router.replace(\"/admin\");\r\n        return;\r\n      }\r\n\r\n      // Check if mobile\r\n      const mobile = window.innerWidth < 768;\r\n      setIsMobile(mobile);\r\n\r\n      if (mobile) {\r\n        setShowSplash(true);\r\n      } else {\r\n        // If desktop, redirect immediately\r\n        router.replace(\"/home\");\r\n      }\r\n    };\r\n\r\n    checkDevice();\r\n  }, [router]);\r\n\r\n  const handleEnter = () => {\r\n    router.push(\"/home\");\r\n  };\r\n\r\n  // While checking or if redirecting desktop, show black loader or nothing\r\n  if (isMobile === null || (!isMobile && !showSplash)) {\r\n    return <div className=\"min-h-[100dvh] bg-black\" />;\r\n  }\r\n\r\n  return (\r\n    <main className=\"min-h-[100dvh] bg-black flex flex-col items-center justify-center relative overflow-hidden\">\r\n\r\n      {/* Background Ambience */}\r\n      <div className=\"absolute inset-0 bg-[radial-gradient(circle_at_center,_var(--tw-gradient-stops))] from-blue-900/20 via-black to-black object-cover\" />\r\n\r\n      <AnimatePresence>\r\n        {showSplash && (\r\n          <motion.div\r\n            initial={{ opacity: 0, scale: 0.9 }}\r\n            animate={{ opacity: 1, scale: 1 }}\r\n            className=\"relative z-10 flex flex-col items-center p-8 text-center\"\r\n          >\r\n            <motion.div\r\n              initial={{ y: 20, opacity: 0 }}\r\n              animate={{ y: 0, opacity: 1 }}\r\n              transition={{ delay: 0.2, duration: 0.8 }}\r\n              className=\"flex flex-col items-center justify-center\"\r\n            >\r\n              <div className=\"fixed inset-0 z-[-1]\">\r\n                <Beams\r\n                  beamWidth={2.0}\r\n                  beamHeight={25}\r\n                  beamNumber={50}\r\n                  speed={2.5}\r\n                  noiseIntensity={3.5}\r\n                  scale={0.15}\r\n                  rotation={25}\r\n                />\r\n              </div>\r\n              <Image\r\n                src=\"/assets/logo-final-wide.png\"\r\n                alt=\"Gentech Guard\"\r\n                width={240}\r\n                height={80}\r\n                className=\"object-contain w-full h-auto hidden\"\r\n                priority\r\n              />\r\n              <div className=\"h-48 w-48 justify-self-center\">\r\n                <MetallicPaint\r\n                  src=\"/assets/gentech-shield-bitmap.svg\"\r\n                  params={{\r\n                    edge: 0.0,\r\n                    patternScale: 2,\r\n                    speed: 0.3,\r\n                    liquid: 0.05\r\n                  }}\r\n                />\r\n              </div>\r\n              <div className=\"h-24 w-80 justify-self-center\">\r\n                <MetallicPaint\r\n                  src=\"/assets/gentech-text-bitmap.svg\"\r\n                  params={{\r\n                    edge: 0.0,\r\n                    patternScale: 2,\r\n                    speed: 0.3,\r\n                    liquid: 0.05\r\n                  }}\r\n                />\r\n              </div>\r\n              <motion.div\r\n                initial={{ y: 20, opacity: 0 }}\r\n                animate={{ y: 0, opacity: 1 }}\r\n                transition={{ delay: 0.6 }}\r\n                className=\"w-full max-w-xs mt-8\"\r\n              >\r\n                <button\r\n                  onClick={handleEnter}\r\n                  className=\"w-full bg-white text-black font-black uppercase tracking-[0.2em] py-4 rounded-full flex items-center justify-center gap-2 hover:bg-gray-200 transition-all active:scale-95 shadow-[0_0_20px_rgba(255,255,255,0.3)]\"\r\n                >\r\n                  Enter <ArrowRight size={18} />\r\n                </button>\r\n                <p className=\"text-white/30 text-[10px] uppercase tracking-widest mt-6\">\r\n                  Premium Paint Protection\r\n                </p>\r\n              </motion.div>\r\n            </motion.div>\r\n\r\n\r\n          </motion.div>\r\n        )}\r\n      </AnimatePresence>\r\n    </main>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AARA;;;;;;;;;AAUe,SAAS;IACtB,MAAM,SAAS,IAAA,+IAAS;IACxB,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,iNAAQ,EAAiB;IACzD,MAAM,CAAC,YAAY,cAAc,GAAG,IAAA,iNAAQ,EAAC;IAE7C,IAAA,kNAAS,EAAC;QACR,MAAM,cAAc;YAClB,yCAAyC;YACzC,MAAM,aAAa,QAAQ,GAAG,CAAC,qBAAqB,KAAK;YAEzD,IAAI,YAAY;gBACd,gDAAgD;gBAChD,OAAO,OAAO,CAAC;gBACf;YACF;YAEA,kBAAkB;YAClB,MAAM,SAAS,OAAO,UAAU,GAAG;YACnC,YAAY;YAEZ,IAAI,QAAQ;gBACV,cAAc;YAChB,OAAO;gBACL,mCAAmC;gBACnC,OAAO,OAAO,CAAC;YACjB;QACF;QAEA;IACF,GAAG;QAAC;KAAO;IAEX,MAAM,cAAc;QAClB,OAAO,IAAI,CAAC;IACd;IAEA,yEAAyE;IACzE,IAAI,aAAa,QAAS,CAAC,YAAY,CAAC,YAAa;QACnD,qBAAO,8OAAC;YAAI,WAAU;;;;;;IACxB;IAEA,qBACE,8OAAC;QAAK,WAAU;;0BAGd,8OAAC;gBAAI,WAAU;;;;;;0BAEf,8OAAC,4MAAe;0BACb,4BACC,8OAAC,oMAAM,CAAC,GAAG;oBACT,SAAS;wBAAE,SAAS;wBAAG,OAAO;oBAAI;oBAClC,SAAS;wBAAE,SAAS;wBAAG,OAAO;oBAAE;oBAChC,WAAU;8BAEV,cAAA,8OAAC,oMAAM,CAAC,GAAG;wBACT,SAAS;4BAAE,GAAG;4BAAI,SAAS;wBAAE;wBAC7B,SAAS;4BAAE,GAAG;4BAAG,SAAS;wBAAE;wBAC5B,YAAY;4BAAE,OAAO;4BAAK,UAAU;wBAAI;wBACxC,WAAU;;0CAEV,8OAAC;gCAAI,WAAU;0CACb,cAAA,8OAAC,+HAAK;oCACJ,WAAW;oCACX,YAAY;oCACZ,YAAY;oCACZ,OAAO;oCACP,gBAAgB;oCAChB,OAAO;oCACP,UAAU;;;;;;;;;;;0CAGd,8OAAC,wIAAK;gCACJ,KAAI;gCACJ,KAAI;gCACJ,OAAO;gCACP,QAAQ;gCACR,WAAU;gCACV,QAAQ;;;;;;0CAEV,8OAAC;gCAAI,WAAU;0CACb,cAAA,8OAAC,uIAAa;oCACZ,KAAI;oCACJ,QAAQ;wCACN,MAAM;wCACN,cAAc;wCACd,OAAO;wCACP,QAAQ;oCACV;;;;;;;;;;;0CAGJ,8OAAC;gCAAI,WAAU;0CACb,cAAA,8OAAC,uIAAa;oCACZ,KAAI;oCACJ,QAAQ;wCACN,MAAM;wCACN,cAAc;wCACd,OAAO;wCACP,QAAQ;oCACV;;;;;;;;;;;0CAGJ,8OAAC,oMAAM,CAAC,GAAG;gCACT,SAAS;oCAAE,GAAG;oCAAI,SAAS;gCAAE;gCAC7B,SAAS;oCAAE,GAAG;oCAAG,SAAS;gCAAE;gCAC5B,YAAY;oCAAE,OAAO;gCAAI;gCACzB,WAAU;;kDAEV,8OAAC;wCACC,SAAS;wCACT,WAAU;;4CACX;0DACO,8OAAC,gOAAU;gDAAC,MAAM;;;;;;;;;;;;kDAE1B,8OAAC;wCAAE,WAAU;kDAA2D;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAYxF"}}]
}